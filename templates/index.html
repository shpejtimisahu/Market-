<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShitBlerje Online</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
 <style>
    body {
        background: linear-gradient(135deg, #f0f2f5, #e6ebff, #fdfdfd);
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #333;
    }

    /* Navbar */
    .navbar {
        background: linear-gradient(90deg, #4e73df, #1cc88a);
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .navbar-brand {
        font-size: 1.4rem;
        font-weight: 700;
        letter-spacing: 0.5px;
    }
    .nav-link {
        color: #fff !important;
        font-weight: 500;
        margin-left: 10px;
        transition: 0.3s;
    }
    .nav-link:hover {
        text-decoration: underline;
        color: #ffe082 !important;
    }

    /* Produktet */
    .card {
        border-radius: 12px;
        overflow: hidden;
        transition: transform 0.3s, box-shadow 0.3s;
        border: none;
    }
    .card:hover {
        transform: translateY(-7px);
        box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    .card-img-top {
        object-fit: cover;
        height: 200px;
    }

    /* Buton “Shto Produkt” */
    .btn-add {
        background-color: #1cc88a;
        color: #fff;
        font-weight: bold;
        border-radius: 8px;
        padding: 10px 18px;
        transition: all 0.3s ease-in-out;
        box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    .btn-add:hover {
        background-color: #17a673;
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.2);
    }

    /* Search bar & categories */
    .search-bar {
        margin: 20px 0;
        border-radius: 8px;
        padding: 12px 15px;
        border: 1px solid #ddd;
        transition: 0.3s;
    }
    .search-bar:focus {
        border-color: #4e73df;
        box-shadow: 0 0 6px rgba(78,115,223,0.3);
    }

    .category-select {
        max-width: 250px;
        border-radius: 8px;
        border: 1px solid #ddd;
        padding: 10px;
        transition: 0.3s;
    }
    .category-select:focus {
        border-color: #1cc88a;
        box-shadow: 0 0 6px rgba(28,200,138,0.3);
    }

    /* Card footer */
    .card-footer {
        background-color: #f8f9fa;
        border-top: 1px solid #eee;
    }

    .badge {
        font-size: 0.85rem;
        padding: 6px 10px;
        border-radius: 6px;
    }
</style>

</head>
<body>


<nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('index') }}">ShitBlerje Online</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                {% if current_user.is_authenticated %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('login') }}">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('register') }}">Register</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>

<div class="container my-4">


    <div class="d-flex justify-content-between align-items-center mb-4">
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('add_product') }}" class="btn btn-add">Shto Produkt</a>
        {% else %}

        {% endif %}
    </div>

    <input type="text" id="searchInput" class="form-control search-bar" placeholder="Kërko produktet...">

    <!-- Filtrim sipas kategorive -->
    <form method="GET" class="mb-4 d-flex">
        <select name="category" onchange="this.form.submit()" class="form-select category-select">
            <option value="" {% if not selected_category %}selected{% endif %}>Të gjitha kategoritë</option>
            {% for cat in categories %}
                <option value="{{ cat }}" {% if selected_category == cat.lower() %}selected{% endif %}>{{ cat }}</option>
            {% endfor %}
        </select>
    </form>

    <!-- Produktet -->
    <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for p in products %}
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="{{ p.image if p.image else 'https://via.placeholder.com/150' }}" class="card-img-top" alt="{{ p.name }}">
                    <div class="card-body">
                        <h5 class="card-title">
                            <a href="{{ url_for('product_detail', product_id=p.id) }}" class="text-decoration-none text-dark">
                                {{ p.name }}
                            </a>
                        </h5>
                        <p class="card-text">{{ p.description }}</p>
                        <span class="badge bg-secondary">{{ p.category }}</span>
                    </div>
<!--                    <div class="card-footer d-flex justify-content-between align-items-center">-->
<!--                        <small class="text-success fw-bold">{{ p.price }} €</small>-->
<!--                        {% if current_user.is_authenticated %}-->
<!--                            <form method="POST" action="{{ url_for('delete_product', product_id=p.id) }}" onsubmit="return confirm('A jeni i sigurt që dëshironi të fshini këtë produkt?');">-->
<!--                                <button type="submit" class="btn btn-sm btn-danger">Fshi</button>-->
<!--                            </form>-->
<!--                        {% endif %}-->
<!--                    </div>-->

                        <div class="card-footer d-flex justify-content-between align-items-center">
                            <small class="text-success fw-bold">{{ p.price }} €</small>
                            {% if current_user.is_authenticated and p.user_id == current_user.id %}
                              <form method="POST" action="{{ url_for('delete_product', product_id=p.id) }}"
                                    onsubmit="return confirm('A jeni i sigurt që dëshironi të fshini këtë produkt?');">
                                  <button type="submit" class="btn btn-sm btn-danger">Fshi</button>
                              </form>
                            {% endif %}
                        </div>

                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
    // Kërkim produktesh live
    const searchInput = document.getElementById('searchInput');
    const productCards = document.querySelectorAll('.card');

    searchInput.addEventListener('input', () => {
        const filter = searchInput.value.toLowerCase();
        productCards.forEach(card => {
            const title = card.querySelector('.card-title').textContent.toLowerCase();
            const desc = card.querySelector('.card-text').textContent.toLowerCase();
            if (title.includes(filter) || desc.includes(filter)) {
                card.parentElement.style.display = '';
            } else {
                card.parentElement.style.display = 'none';
            }
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
